<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ComponentBase.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;JWebSwing&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">za.co.mmagon.jwebswing.base</a> &gt; <span class="el_source">ComponentBase.java</span></div><h1>ComponentBase.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2016 ged_m
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
 */
package za.co.mmagon.jwebswing.base;

import com.fasterxml.jackson.annotation.*;
import java.util.*;
import java.util.logging.Level;
import za.co.mmagon.jwebswing.base.interfaces.IComponentBase;
import za.co.mmagon.jwebswing.base.servlets.enumarations.ComponentTypes;
import za.co.mmagon.jwebswing.htmlbuilder.javascript.JavaScriptPart;
import za.co.mmagon.jwebswing.utilities.GUIDGenerator;
import za.co.mmagon.logger.LogFactory;

/**
 * Defines the raw necessities for a component to exist
 *
 * @param &lt;J&gt; Component output for cloning. Always make it this class to make life easy
 *
 * @author GedMarc
 * @since 22 Apr 2016
 */
@JsonAutoDetect(fieldVisibility = JsonAutoDetect.Visibility.ANY, getterVisibility = JsonAutoDetect.Visibility.NONE, setterVisibility = JsonAutoDetect.Visibility.NONE)
@JsonInclude(JsonInclude.Include.NON_NULL)
public class ComponentBase&lt;J extends ComponentBase&gt; implements IComponentBase&lt;J&gt;
{

    /**
     * Logger for the Component
     */
    @JsonIgnore
<span class="fc" id="L45">    protected static final java.util.logging.Logger logShell = LogFactory.getLog(&quot;ComponentBase&quot;);</span>

    /**
     * Serial Version for all Components and their compatibility
     *
     * @version 2 Version 2 - Updated CSS Library and References
     */
    @JsonIgnore
    private static final long serialVersionUID = 1l;

    /**
     * The ID of the component rendering for
     */
    private String id;

    /**
     * The enumeration component type associated with this class to escape the use of &quot;instance of&quot; statements. performance thing
     */
    private ComponentTypes componentType;

    /**
     * Any raw text that should be built into this component. Rendered before children
     */
    private String text;

    /**
     * Specifies if this component should render as small as possible
     */
    private boolean tiny;
    /**
     * Whether this component has been configured or not
     */
    private boolean configured;
    /**
     * Initialized flag
     */
    private boolean initialized;
    /**
     * Sets if this component should be sent on the next call back
     */
<span class="fc" id="L85">    private boolean touched = false;</span>
    /**
     * A set of properties for this component
     */
    @JsonInclude(JsonInclude.Include.NON_EMPTY)
    private HashMap&lt;String, Object&gt; properties;

    /**
     * Constructs a new Component Shell
     *
     * @param componentType
     */
    public ComponentBase(ComponentTypes componentType)
<span class="fc" id="L98">    {</span>
<span class="fc" id="L99">        this.id = GUIDGenerator.generateGuid();</span>
<span class="fc" id="L100">        this.componentType = componentType;</span>
<span class="fc" id="L101">    }</span>

    /**
     * Returns an Attribute Base interface of this component
     *
     * @return
     */
    public IComponentBase asBase()
    {
<span class="nc" id="L110">        return (ComponentBase) this;</span>
    }

    /**
     * Gets the ID of this component
     * &lt;p&gt;
     * @return The ID of this component
     */
    @Override
    public String getID()
    {
<span class="fc" id="L121">        return this.id;</span>
    }

    /**
     * Returns the ID with the # in the front of it
     * &lt;p&gt;
     * @param jQueryHolder Anything
     * &lt;p&gt;
     * @return An ID starting with #
     */
    @Override
    public String getID(boolean jQueryHolder)
    {
<span class="fc" id="L134">        return &quot;#&quot; + this.id;</span>
    }

    /**
     * Returns the component rendering for JQuery string Requires the rendering for component is set
     * &lt;p&gt;
     * @return $('#x').
     */
    @Override
    public String getJQueryID()
    {
<span class="fc" id="L145">        return &quot;$(\'&quot; + getID(true) + &quot;\').&quot;;</span>
    }

    /**
     * Sets the ID of this component
     * &lt;p&gt;
     * @param id The ID
     */
    @Override
    public J setID(String id)
    {
<span class="fc" id="L156">        this.id = id;</span>
<span class="fc" id="L157">        return (J) this;</span>
    }

    /**
     * Gets this components enumeration
     * &lt;p&gt;
     * @return The Component Enumeration of this component
     */
    protected ComponentTypes getComponentType()
    {
<span class="fc" id="L167">        return componentType;</span>
    }

    /**
     * Sets this components enumeration. Currently little more than an easy to compare Enum
     * &lt;p&gt;
     * @param componentType The component to mimic
     *
     * @return
     */
    protected J setComponentType(ComponentTypes componentType)
    {
<span class="fc" id="L179">        this.componentType = componentType;</span>
<span class="fc" id="L180">        return (J) this;</span>
    }

    /**
     * Appends the text used as raw text outside the tags to the incoming StringBuilder
     * &lt;p&gt;
     * @param sb The StringBuilder to append to
     * &lt;p&gt;
     * @return The current set Raw Text
     */
    protected StringBuilder getText(StringBuilder sb)
    {
<span class="fc bfc" id="L192" title="All 2 branches covered.">        if (text == null)</span>
        {
<span class="fc" id="L194">            return new StringBuilder();</span>
        }
        else
        {
<span class="fc" id="L198">            sb.append(text);</span>
<span class="fc" id="L199">            return sb;</span>
        }
    }

    /**
     * returns a new StringSuilder of the raw text with the specific tab counts
     * &lt;p&gt;
     * @param tabCounts &lt;p&gt;
     * @return
     */
    @Override
    public StringBuilder getText(int tabCounts)
    {
<span class="fc" id="L212">        StringBuilder sb = new StringBuilder();</span>
<span class="fc" id="L213">        getText(sb);</span>
<span class="fc" id="L214">        return sb;</span>
    }

    /**
     * Sets this components Raw Text
     * &lt;p&gt;
     * @param text The text to display as Raw Text
     */
    @Override
    public J setText(String text)
    {
<span class="fc" id="L225">        this.text = text;</span>
<span class="fc" id="L226">        return (J) this;</span>
    }

    /**
     * Sets this components Raw Text
     * &lt;p&gt;
     * @param text The text to display as Raw Text
     */
    @Override
    public J setText(StringBuilder text)
    {
<span class="fc" id="L237">        this.text = text.toString();</span>
<span class="fc" id="L238">        return (J) this;</span>
    }

    /**
     * Clones this component and assigns a new ID
     * &lt;p&gt;
     * @return The cloned component
     */
    @Override
    public J cloneComponent()
    {
<span class="fc" id="L249">        J component = null;</span>
        try
        {
<span class="fc" id="L252">            component = (J) this.clone();</span>
<span class="fc" id="L253">            component.setID(GUIDGenerator.generateGuid());</span>
        }
<span class="nc" id="L255">        catch (CloneNotSupportedException ex)</span>
        {
<span class="nc" id="L257">            logShell.log(Level.SEVERE, &quot;Cloning Error in Shell&quot;, ex);</span>
<span class="fc" id="L258">        }</span>
<span class="fc" id="L259">        return component;</span>
    }

    /**
     * Specifies whether or not to render this component in a Production/QA fashion
     * &lt;p&gt;
     * @return If this component will render in production mode
     */
    @Override
    public boolean isTiny()
    {
<span class="fc" id="L270">        return this.tiny;</span>
    }

    /**
     * If this component will render as tiny HTML. Global override value
     * &lt;p&gt;
     * @param tiny Set if this component must render as tiny HTML. Does not affect CSS or JavaScript rendering
     */
    @Override
    public J setTiny(boolean tiny)
    {
<span class="fc" id="L281">        this.tiny = tiny;</span>
<span class="fc" id="L282">        return (J) this;</span>
    }

    /**
     * Returns the new line character according to Running Environment
     * &lt;p&gt;
     * @return A new line if is in development mode
     */
    @Override
    public String getNewLine()
    {
<span class="fc bfc" id="L293" title="All 2 branches covered.">        if (!isTiny())</span>
        {
<span class="fc" id="L295">            return &quot;\n&quot;;</span>
        }
        else
        {
<span class="fc" id="L299">            return &quot;&quot;;</span>
        }
    }

    /**
     * Run-Once on creation Executes a piece of code before running any rendering. Call super after your changes Marks the component as configured
     */
    @Override
    public void preConfigure()
    {
<span class="fc" id="L309">        setConfigured(true);</span>
<span class="fc" id="L310">    }</span>

    /**
     * If this component is already configured
     *
     * @return
     */
    @Override
    public boolean isConfigured()
    {
<span class="fc" id="L320">        return configured;</span>
    }

    /**
     * If this component is already configured
     *
     * @param configured
     */
    @Override
    public J setConfigured(boolean configured)
    {
<span class="fc" id="L331">        this.configured = configured;</span>
<span class="fc" id="L332">        return (J) this;</span>
    }

    /**
     * Returns a map of user defined properties for this component
     *
     * @return
     */
    @Override
    public Map&lt;String, Object&gt; getProperties()
    {
<span class="pc bpc" id="L343" title="1 of 2 branches missed.">        if (properties == null)</span>
        {
<span class="fc" id="L345">            properties = new HashMap&lt;&gt;();</span>
        }
<span class="fc" id="L347">        return properties;</span>
    }

    /**
     * Sets this components user defined properties
     *
     * @param properties
     */
    @Override
    public J setProperties(HashMap&lt;String, Object&gt; properties)
    {
<span class="nc" id="L358">        this.properties = properties;</span>
<span class="nc" id="L359">        return (J) this;</span>
    }

    /**
     * Default HashCode over-ride
     *
     * @return
     */
    @Override
    public int hashCode()
    {
<span class="nc" id="L370">        int hash = 7;</span>
<span class="nc" id="L371">        hash = 23 * hash + Objects.hashCode(this.id);</span>
<span class="nc" id="L372">        hash = 23 * hash + Objects.hashCode(this.componentType);</span>
<span class="nc" id="L373">        hash = 23 * hash + Objects.hashCode(this.text);</span>
<span class="nc" id="L374">        return hash;</span>
    }

    /**
     * Default equals for a component
     *
     * @param obj The incoming object
     *
     * @return True if the ID, Type and Text are the same
     */
    @Override
    public boolean equals(Object obj)
    {
<span class="nc bnc" id="L387" title="All 2 branches missed.">        if (this == obj)</span>
        {
<span class="nc" id="L389">            return true;</span>
        }
<span class="nc bnc" id="L391" title="All 2 branches missed.">        if (obj == null)</span>
        {
<span class="nc" id="L393">            return false;</span>
        }
<span class="nc bnc" id="L395" title="All 2 branches missed.">        if (getClass() != obj.getClass())</span>
        {
<span class="nc" id="L397">            return false;</span>
        }
<span class="nc" id="L399">        final ComponentBase&lt;?&gt; other = (ComponentBase&lt;?&gt;) obj;</span>
<span class="nc bnc" id="L400" title="All 2 branches missed.">        if (!Objects.equals(this.id, other.id))</span>
        {
<span class="nc" id="L402">            return false;</span>
        }
<span class="nc bnc" id="L404" title="All 2 branches missed.">        if (!Objects.equals(this.text, other.text))</span>
        {
<span class="nc" id="L406">            return false;</span>
        }
<span class="nc bnc" id="L408" title="All 2 branches missed.">        return this.componentType == other.componentType;</span>
    }

    /**
     * Renders the component as a JSON Object
     *
     * @return
     */
    @Override
    public String toString()
    {
<span class="fc bfc" id="L419" title="All 2 branches covered.">        if (!isConfigured())</span>
        {
<span class="fc" id="L421">            init();</span>
<span class="fc" id="L422">            preConfigure();</span>
        }
<span class="fc" id="L424">        return JavaScriptPart.objectAsString(this);</span>
    }

    /**
     * Runs before anything Can be used as constructor intializations.
     */
    public void init()
    {

<span class="fc" id="L433">        setInitialized(true);</span>
<span class="fc" id="L434">    }</span>

    /**
     * If this component has been initialized
     *
     * @return
     */
    public boolean isInitialized()
    {
<span class="fc" id="L443">        return initialized;</span>
    }

    /**
     * If this component has been initialized
     *
     * @param initialized
     *
     * @return
     */
    public J setInitialized(boolean initialized)
    {
<span class="fc" id="L455">        this.initialized = initialized;</span>
<span class="fc" id="L456">        return (J) this;</span>
    }

    /**
     * Returns if this component is needing refresh on next Ajax call
     * &lt;p&gt;
     * @return true if going to be touched
     */
    @Override
    public boolean isTouched()
    {
<span class="fc" id="L467">        return touched;</span>
    }

    /**
     * Mark this component as needing refresh to the Ajax Controller
     * &lt;p&gt;
     * @param touched Whether or not to update on next ajax call
     *
     * @return
     */
    @Override
    public J setTouched(boolean touched)
    {
<span class="nc" id="L480">        this.touched = touched;</span>
<span class="nc" id="L481">        return (J) this;</span>
    }

    /**
     * For JSON Reconstruction
     *
     * @return
     */
    @JsonProperty(&quot;componentClass&quot;)
    protected String getComponentClass()
    {
<span class="fc" id="L492">        return getClass().getCanonicalName();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>